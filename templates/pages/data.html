{% extends 'base.html' %}
{% block content %}



<br>
<div class="containers">
    <div class="left-images">
        <section class ="box-line" style="width:40vw; ">
            <h3> ë°°í„°ë¦¬ ì •ë³´ </h3>

            <hr>
            <br>
            <div class="battery-story" style="margin-top:0px; ">
                    <p style="margin-bottom: 0px;">
                        EMS ì‹œìŠ¤í…œìƒ ë¶„ë¥˜ : ë‹¨ê¸° ë°°í„°ë¦¬ <br>
                        ì¢…ë¥˜ : ë¦¬íŠ¬-ì´ì˜¨ ë°°í„°ë¦¬ <br>
                        ìµœëŒ€ ìš©ëŸ‰ : 9916.665kWh<br>
                        ê³„ì ˆë³„ í•œê³„ ìš©ëŸ‰ :
                    </p>
                    <!-- ë‘ ì¤„ì˜ í‘œ ì¶”ê°€ -->
                    <table class="capacity-table">
                        <thead>
                            <tr>
                                <th>ê³„ì ˆ</th>
                                <th>í‘œì¤€ ìµœëŒ€ ìš©ëŸ‰ (kWh)</th>
                                <th>íš¨ìœ¨ ìµœëŒ€ ìš©ëŸ‰ (kWh)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ê²¨ìš¸</td>
                                <td>7,933.332</td>
                                <td>8,924.9985</td>
                            </tr>
                            <tr>
                                <td style="width:70px;">ë´„ / ê°€ì„</td>
                                <td>7,437.49875</td>
                                <td>8,429.16525</td>
                            </tr>
                            <tr>
                                <td>ì—¬ë¦„</td>
                                <td>6,941.6655</td>
                                <td>7,933.332</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="margin-bottom: 0px;">
                        ì¶©,ë°©ì „ íš¨ìœ¨ : <br>
                    </p>
                    <table class="capacity-table">
                        <thead>
                            <tr>
                                <th>ì¶©ì „ íš¨ìœ¨</th>
                                <th>ê³µê¸‰ íš¨ìœ¨</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>90%</td>
                                <td>99.7%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            <br><br>
            <hr style="color:#d2d2d2;">
            <br><br>
            <div class="battery-story" style="margin-top:0px;">
                <p style="margin-bottom: 0px;">
                        EMS ì‹œìŠ¤í…œìƒ ë¶„ë¥˜ : ì¥ê¸° ë°°í„°ë¦¬  <br>
                        ì¢…ë¥˜ : ìˆ˜ì†Œ ë°°í„°ë¦¬  <br>
                        ìµœëŒ€ ìš©ëŸ‰ : 1000000kWh<br>
                        ê³„ì ˆë³„ í•œê³„ ìš©ëŸ‰ :
                </p>
                <!-- ë‘ ì¤„ì˜ í‘œ ì¶”ê°€ -->
                    <table class="capacity-table">
                        <thead>
                            <tr>
                                <th>ê³„ì ˆ</th>
                                <th>í‘œì¤€ ìµœëŒ€ ìš©ëŸ‰ (kWh)</th>
                                <th>íš¨ìœ¨ ìµœëŒ€ ìš©ëŸ‰ (kWh)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ê²¨ìš¸</td>
                                <td>7,933.332</td>
                                <td>8,924.9985</td>
                            </tr>
                            <tr>
                                <td style="width:70px;">ë´„ / ê°€ì„</td>
                                <td>7,437.49875</td>
                                <td>8,429.16525</td>
                            </tr>
                            <tr>
                                <td>ì—¬ë¦„</td>
                                <td>6,941.6655</td>
                                <td>7,933.332</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="margin-bottom: 0px;">
                        ì¶©,ë°©ì „ íš¨ìœ¨ : <br>
                    </p>
                    <table class="capacity-table">
                        <thead>
                            <tr>
                                <th>ì¶©ì „ íš¨ìœ¨</th>
                                <th>ê³µê¸‰ íš¨ìœ¨</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>65.8%</td>
                                <td>60%</td>
                            </tr>
                        </tbody>
                    </table>
                <br>
                </div>
        </section>
        <br><br>
    </div>
    <div class="right-images">
    <div class="right-data">
        <section class ="box-line" style="width:48vw;">
            <div class="data-container">
                <h2 style="text-align: center; margin-bottom: 15px; color: #333; font-size: 18px;">ë°ì´í„° ìë£Œ</h2>

                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="ê²€ìƒ‰">
                    <span class="search-icon">ğŸ”</span>
                </div>

                <ul id="dataList" class="data-list">
                    <!-- ë°ì´í„° í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </ul>
            </div>
        </section>
    </div>
        <br><br>
    <section class ="box-line" style="width:48vw;">
            <h3> ê°€ë¡œë“± </h3>
            <hr style="width:45vw; margin-left: inherit;">
            <p> ê°€ë¡œë“± ê°œìˆ˜ : 400 ëŒ€ <br>
                ê°€ë¡œë“± í•œ ëŒ€ ê¸°ì¤€ ì „ë ¥ ì†Œë¹„ëŸ‰ : 15W <br>
                ê°€ë¡œë“± ê³„ì ˆë³„ ì ë“± ì‹œê°„ (AIíŒë‹¨) <br>
            </p>
        <table class="capacity-table" style="width:95%;">
                        <thead>
                            <tr>
                                <th>ê³„ì ˆ</th>
                                <th >ê°€ë¡œë“± ì¼œì§€ëŠ” ì‹œê°„</th>
                                <th>ê°€ë¡œë“± êº¼ì§€ëŠ” ì‹œê°</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ê²¨ìš¸</td>
                                <td>17:00</td>
                                <td>07:00</td>
                            </tr>
                            <tr>
                                <td style="width:70px;">ë´„ / ê°€ì„</td>
                                <td>18:00</td>
                                <td>06:00</td>
                            </tr>
                            <tr>
                                <td>ì—¬ë¦„</td>
                                <td>20:00</td>
                                <td>05:00</td>
                            </tr>
                        </tbody>
                    </table>
        <br>
    </section>
    </div>
</div>

<!-- ì‚¬ìš©ì ì •ì˜ ëª¨ë‹¬ -->
<div id="myModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span>íŒŒì¼ ì²˜ë¦¬ ì„ íƒ</span>
            <span class="close-button" id="closeModal">&times;</span>
        </div>
        <div class="modal-body">
            <p>íŒŒì¼ì„ ì—´ëŒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        </div>
        <div class="modal-footer">
            <button class="modal-button" id="confirmBtn">í™•ì¸</button>
            <button class="modal-button download" id="downloadBtn">ë‹¤ìš´ë¡œë“œ</button>
            <button class="modal-button cancel" id="cancelBtn">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const resources = [
        'ì˜ì‚¬ê²°ì • AI ì˜ˆì¸¡ ê²°ê³¼(2024).csv',
        'ì˜ì‚¬ê²°ì • AI í•™ìŠµìš© ë°ì´í„° ì…‹ 2 (2024).csv',
        'ì˜ì‚¬ê²°ì • AI í•™ìŠµìš© ë°ì´í„° ì…‹ 1 (2023).csv',
        'íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ê°’ (2024).csv',
        'íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ê°’ (2023).csv',
        'íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ AI í•™ìŠµìš© ë°ì´í„° ì…‹ (ê¸°ìƒì²­ ë°ì´í„° ë° íƒœì–‘ê´‘ ë°œì „ëŸ‰ í†µí•©, 2024).csv',
        'íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ AI í•™ìŠµìš© ë°ì´í„° ì…‹ (ê¸°ìƒì²­ ë°ì´í„° ë° íƒœì–‘ê´‘ ë°œì „ëŸ‰ í†µí•©, 2023).csv',
        'ì•Œê³ ë¦¬ì¦˜ ë¹„êµ ë¶„ì„ ìë£Œ (íƒœì–‘ê´‘ ë°œì „ ê¸°ë°˜ ê°€ë¡œë“± EMSì˜ AI ìµœì í™” ì„¤ê³„ ë° ì„±ëŠ¥ ë¹„êµ ë¶„ì„).pdf',
    ];

    const searchInput = document.getElementById('searchInput');
    const dataList = document.getElementById('dataList');
    const modal = document.getElementById('myModal');
    const modalContent = document.querySelector('.modal-content');
    const closeModal = document.getElementById('closeModal');
    const confirmBtn = document.getElementById('confirmBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    let currentResource;

    function renderResources(filteredResources) {
        dataList.innerHTML = '';
        filteredResources.forEach(resource => {
            const li = document.createElement('li');
            li.className = 'data-item';
            li.textContent = resource;
            li.addEventListener('click', function() {
                currentResource = resource;
                modalContent.classList.add('show');
                modal.style.display = 'block';
            });
            dataList.appendChild(li);
        });

        if (filteredResources.length === 0) {
            const li = document.createElement('li');
            li.className = 'data-item';
            li.textContent = 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.';
            dataList.appendChild(li);
        }
    }

    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const filteredResources = resources.filter(resource =>
            resource.toLowerCase().includes(searchTerm)
        );
        renderResources(filteredResources);
    });

    confirmBtn.addEventListener('click', function() {
        const fileExtension = currentResource.split('.').pop().toLowerCase();
        const fileName = encodeURIComponent(currentResource);
        const fileUrl = `/open_file/${fileName}`;

        if (fileExtension === 'pdf') {
            window.open(fileUrl, '_blank');
        } else if (fileExtension === 'csv') {
            fetch(fileUrl)
                .then(response => response.text())
                .then(data => {
                    const csvData = Papa.parse(data, { header: true });
                    let html = '<table border="1" style="width: 100%; border-collapse: collapse;"><thead><tr>';
                    Object.keys(csvData.data[0]).forEach(key => {
                        html += `<th>${key}</th>`;
                    });
                    html += '</tr></thead><tbody>';
                    csvData.data.forEach(row => {
                        html += '<tr>';
                        Object.values(row).forEach(value => {
                            html += `<td>${value}</td>`;
                        });
                        html += '</tr>';
                    });
                    html += '</tbody></table>';
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write('<html><head><title>' + currentResource + '</title></head><body>' + html + '</body></html>');
                    newWindow.document.close();
                })
                .catch(error => {
                    console.error('Error loading CSV file:', error);
                    alert('CSV íŒŒì¼ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
        } else {
            alert('ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.');
        }

        modal.style.display = 'none';
        modalContent.classList.remove('show');
    });

    downloadBtn.addEventListener('click', function() {
        const fileName = encodeURIComponent(currentResource);
        const fileUrl = `/open_file/${fileName}`;
        window.location.href = fileUrl;
        modal.style.display = 'none';
        modalContent.classList.remove('show');
    });

    cancelBtn.addEventListener('click', function() {
        modal.style.display = 'none';
        modalContent.classList.remove('show');
    });

    closeModal.addEventListener('click', function() {
        modal.style.display = 'none';
        modalContent.classList.remove('show');
    });

    window.onclick = function(event) {
        if (event.target === modal) {
            modal.style.display = 'none';
            modalContent.classList.remove('show');
        }
    };

    renderResources(resources);
});
</script>

{% endblock %}
